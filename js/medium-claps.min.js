"use strict";

export function MediumClaps() {
    var p = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : { feedUrl: "", root: "#claps-container", template: "#post-template", missingImage: "" },
        e = "#claps-container",
        t = "#post-template";
    if (p.root || (p.root = e), p.template || (p.template = t), !p.feedUrl) throw "Config incomplete. Please provide a feed URL.";
    if (!p.missingImage) throw "Config incomplete. Please provide a missing image.";
    var m = "{{postLink}}",
        d = "{{postTitle}}",
        u = "{{postAuthor}}",
        f = "{{postImage}}";
    fetch(p.feedUrl).then(function(e) { return e.json() }).then(function(e) { return (new RSSParser).parseString(e.contents) }).then(function(e) {
        var t = !0,
            n = !1,
            o = void 0;
        try {
            for (var c, r = function() {
                    var e, t, n, o, r = c.value,
                        i = (e = r["content:encoded"], (t = /<img.*?src="https:\/\/cdn-(.*?)"/.exec(e)) ? "https://cdn-" + t[1] : p.missingImage),
                        a = { authorName: r.creator, postImage: i, postLink: r.link, postTitle: r.title },
                        l = document.querySelector(p.template).content.cloneNode(!0).firstElementChild.outerHTML.replace(m, a.postLink).replace(d, a.postTitle).replace(u, a.authorName).replace(f, a.postImage),
                        s = (n = l, (o = document.createElement("div")).innerHTML = n.trim(), o.firstChild);
                    document.querySelector(p.root).appendChild(s), window.setTimeout(function() { return s.classList.add("is-visible") }, 100)
                }, i = e.items[Symbol.iterator](); !(t = (c = i.next()).done); t = !0) r()
        } catch (e) { n = !0, o = e } finally { try { t || null == i.return || i.return() } finally { if (n) throw o } }
    }).catch(console.log)
}